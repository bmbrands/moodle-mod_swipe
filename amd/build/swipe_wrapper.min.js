define ("mod_swipe/swipe_wrapper",["jquery","core/custom_interaction_events","core/notification","core/ajax","mod_swipe/transform","mod_swipe/tinder","mod_swipe/textFit"],function(a,b,c,d,e,f,g){var h={WRAPPER:"[data-region=\"swipe-wrapper\"]",LIKE:"[data-action=\"like\"]",DISLIKE:"[data-action=\"dislike\"]",VIEW_INFO:"[data-action=\"info\"]",CLOSE_INFO:"[data-action=\"close-info\"]",ACTION_CONTAINER:"[data-region=\"cardactions\"]",INFO_CONTAINER:"[data-region=\"card-info\"]",CARD_IMAGE:"[data-region=\"card-image\"]",CARD_VIDEO:"[data-region=\"card-video\"]",FEEDBACK_CONTAINER:"[data-region=\"feedback-container\"]",FEEDBACK_INPUT:"[data-region=\"feedback-input\"]",FEEDBACK_SEND:"[data-action=\"send-feedback\"]",FEEDBACK_THANKS:"[data-region=\"feedback-thanks\"]",FEEDBACK_TEXT:"[data-region=\"feedback-text\"]"},i={IMAGE:1,VIDEO:2,TEXT:3},j=function(a,b){var e=d.call([{methodname:"mod_swipe_like",args:{itemid:a,like:b}}])[0];e.fail(c.exception);return e},k=function(a,b){var e=d.call([{methodname:"mod_swipe_feedback",args:{swipeid:a,feedback:b}}])[0];e.fail(c.exception);return e},l=function(a){var b=a.find(h.ACTION_CONTAINER);return b.attr("data-current-card")},m=function(a,b){if(b){var c=a.find("[data-card-id="+b+"]");return c}},n=function(a){var b=a.find(h.INFO_CONTAINER),c=b.attr("data-status");if("closed"==c){b.css("top","0");b.attr("data-status","open")}else{b.css("top","-420px");b.attr("data-status","closed")}},o=function(c){b.define(c,[b.events.activate]);c.on(b.events.activate,h.VIEW_INFO,function(a,b){var d=l(c),e=m(c,d);n(e);b.originalEvent.preventDefault()});c.on(b.events.activate,h.CLOSE_INFO,function(a,b){var d=l(c),e=m(c,d);n(e);b.originalEvent.preventDefault()});c.on(b.events.activate,h.LIKE,function(b,c){a("#tinderslide").jTinder("like");c.originalEvent.preventDefault()});c.on(b.events.activate,h.DISLIKE,function(b,c){a("#tinderslide").jTinder("dislike");c.originalEvent.preventDefault()});c.on(b.events.activate,h.FEEDBACK_SEND,function(a,b){var d=c.find(h.FEEDBACK_CONTAINER),e=d.find(h.FEEDBACK_INPUT),f=d.find(h.FEEDBACK_TEXT),g=d.find(h.FEEDBACK_THANKS),i=d.attr("data-swipeid"),j=f.val();k(i,j).then(function(){e.addClass("hidden");g.removeClass("hidden")});b.originalEvent.preventDefault()})},p=function(a,b){var c=m(a,b);if(!c.length){return}var d=c.attr("data-card-type");if(d==i.VIDEO){var e=c.find("iframe");if(e.length){var f=e.attr("src");e.attr("src","");e.attr("src",f)}}var g=c.attr("data-preload");if(c.attr("data-last")){a.find(h.ACTION_CONTAINER).addClass("hidden");a.find(h.FEEDBACK_CONTAINER).removeClass("hidden");a.find(h.WRAPPER).addClass("hidden")}if(g){var j=m(a,g);if(j.attr("data-card-type")==i.IMAGE){var k=j.attr("data-card-image");j.find(h.CARD_IMAGE).attr("style","background-image: url("+k+")")}if(j.attr("data-card-type")==i.VIDEO){var f=j.attr("data-card-video");j.find(h.CARD_VIDEO).attr("src",f)}}};return{init:function init(b){var b=a(b);g(document.getElementsByClassName("innertext"),{multiLine:!0});a("#tinderslide").jTinder({onDislike:function onDislike(){var a=l(b);j(a,!1);p(b,a)},onLike:function onLike(){var a=l(b);j(a,!0);p(b,a)},animationRevertSpeed:200,animationSpeed:400,threshold:1,likeSelector:".like",dislikeSelector:".dislike"});o(b)}}});
//# sourceMappingURL=swipe_wrapper.min.js.map
